class DBHelper{static get DATABASE_URL(){return"http://localhost:8000/data/restaurants.json"}static fetchRestaurants(e){let t=new XMLHttpRequest;t.open("GET",DBHelper.DATABASE_URL),t.onload=(()=>{if(200===t.status){const n=JSON.parse(t.responseText).restaurants;e(null,n)}else{const n=`Request failed. Returned status of ${t.status}`;e(n,null)}}),t.send()}static fetchRestaurantById(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.find(t=>t.id==e);n?t(null,n):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.filter(t=>t.cuisine_type==e);t(null,n)}})}static fetchRestaurantByNeighborhood(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.filter(t=>t.neighborhood==e);t(null,n)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,n){DBHelper.fetchRestaurants((a,r)=>{if(a)n(a,null);else{let a=r;"all"!=e&&(a=a.filter(t=>t.cuisine_type==e)),"all"!=t&&(a=a.filter(e=>e.neighborhood==t)),n(null,a)}})}static fetchNeighborhoods(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].neighborhood),a=t.filter((e,n)=>t.indexOf(e)==n);e(null,a)}})}static fetchCuisines(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].cuisine_type),a=t.filter((e,n)=>t.indexOf(e)==n);e(null,a)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}`}static mapMarkerForRestaurant(e,t){const n=new L.marker([e.latlng.lat,e.latlng.lng],{title:e.name,alt:e.name,keyboard:!1,url:DBHelper.urlForRestaurant(e)});return n.addTo(newMap),n}}let restaurants,neighborhoods,cuisines;var markers=[];let restaurant;var newMap;document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines(),tabOrder()}),tabOrder=(()=>{var e=document.getElementsByClassName("leaflet-control-zoom-in"),t=document.getElementsByClassName("leaflet-control-zoom-out");document.getElementsByClassName("leaflet-control-attribution")[0].firstChild.setAttribute("tabindex","-1"),e[0].setAttribute("tabindex","-1"),t[0].setAttribute("tabindex","-1")}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");t.setAttribute("role","menu"),t.setAttribute("aria-label","Neighborhood Filter Menu"),e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,n.tabIndex="0",t.append(n)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");t.setAttribute("role","menu"),t.setAttribute("aria-label","Cuisine Filter Menu"),e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,n.tabIndex="0",t.append(n)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,keyboard:!1,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYWFzYWxhemFyMjMiLCJhIjoiY2prd3QyMzEwMDFlYTN2cDRwdGxzc2xxNSJ9.6TWd0k6o60IPKrUBkKxbww",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/" tabindex="-1">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/" tabindex="-1">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/" tabindex="-1">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,s=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,s,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(e=>e.remove()),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),n=document.createElement("img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e),n.alt=e.alt_text,n.tabIndex="0",t.append(n);const a=document.createElement("div");a.className="restaurant-card",t.append(a);const r=document.createElement("a");r.className="restaurant-name",r.innerHTML=e.name,r.tabIndex="0",r.href=DBHelper.urlForRestaurant(e),a.append(r);const s=document.createElement("p");s.className="restaurant-neighborhood",s.innerHTML=e.neighborhood,s.tabIndex="0",a.append(s);const o=document.createElement("p");return o.className="restaurant-address",o.innerHTML=e.address,s.tabIndex="0",a.append(o),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t),map=document.getElementById("map"),map.tabIndex=-1})}),document.addEventListener("DOMContentLoaded",e=>{initMap()}),tabOrder=(()=>{var e=document.getElementsByClassName("leaflet-control-zoom-in"),t=document.getElementsByClassName("leaflet-control-zoom-out"),n=document.getElementsByClassName("leaflet-control-attribution"),a=document.getElementById("map");n[0].firstChild.setAttribute("tabindex","-1"),e[0].setAttribute("tabindex","-1"),t[0].setAttribute("tabindex","-1"),a.setAttribute("tabindex","-1")}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiYWFzYWxhemFyMjMiLCJhIjoiY2prd3QyMzEwMDFlYTN2cDRwdGxzc2xxNSJ9.6TWd0k6o60IPKrUBkKxbww",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/" tabindex="-1">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/" tabindex="-1">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/" tabindex="-1">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap),tabOrder())})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{const t=document.getElementById("restaurant-name");t.className="info-name",t.innerHTML=e.name,t.setAttribute("tabindex","0");const n=document.getElementById("restaurant-cuisine");n.className="info-cuisine",n.innerHTML=e.cuisine_type,n.setAttribute("tabindex","0");const a=document.getElementById("restaurant-address");a.className="info-address",a.innerHTML=e.address,a.setAttribute("tabindex","0");const r=document.getElementById("restaurant-img");r.className="restaurant-img",r.src=DBHelper.imageUrlForRestaurant(e),r.setAttribute("alt",e.alt_text),r.setAttribute("tabindex","0"),e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");t.className="restaurant-hours",t.setAttribute("tabindex","0");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);const s=document.createElement("td");s.innerHTML=e[n],a.appendChild(s),t.appendChild(a)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),createReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("tabindex","0");const n=document.createElement("p");n.className="review-name",n.innerHTML=e.name,t.appendChild(n);const a=document.createElement("p");a.className="review-date",a.innerHTML=e.date,t.appendChild(a);const r=document.createElement("p");r.className="review-rating",r.innerHTML=`Rating: ${e.rating}`,t.appendChild(r);const s=document.createElement("p");return s.className="review-comments",s.innerHTML=e.comments,t.appendChild(s),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("Service registration successful with scope: ",e.scope)},function(e){console.log("Service worker failed: ",e)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIiwibWFpbi5qcyIsInJlc3RhdXJhbnRfaW5mby5qcyIsInN3X3N0YXJ0ZXIuanMiXSwibmFtZXMiOlsiREJIZWxwZXIiLCJEQVRBQkFTRV9VUkwiLCJbb2JqZWN0IE9iamVjdF0iLCJjYWxsYmFjayIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ubG9hZCIsInN0YXR1cyIsInJlc3RhdXJhbnRzIiwiSlNPTiIsInBhcnNlIiwicmVzcG9uc2VUZXh0IiwiZXJyb3IiLCJzZW5kIiwiaWQiLCJmZXRjaFJlc3RhdXJhbnRzIiwicmVzdGF1cmFudCIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2RzIiwibWFwIiwidiIsImkiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJwaG90b2dyYXBoIiwibWFya2VyIiwiTCIsImxhdGxuZyIsImxhdCIsImxuZyIsInRpdGxlIiwibmFtZSIsImFsdCIsImtleWJvYXJkIiwidXJsIiwidXJsRm9yUmVzdGF1cmFudCIsImFkZFRvIiwibmV3TWFwIiwibWFya2VycyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiaW5pdE1hcCIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJ0YWJPcmRlciIsInpvb20iLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwib3V0IiwiZmlyc3RDaGlsZCIsInNldEF0dHJpYnV0ZSIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwidGFiSW5kZXgiLCJhcHBlbmQiLCJmaWxsQ3Vpc2luZXNIVE1MIiwiY2VudGVyIiwic2Nyb2xsV2hlZWxab29tIiwidGlsZUxheWVyIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJuU2VsZWN0IiwiY0luZGV4Iiwic2VsZWN0ZWRJbmRleCIsIm5JbmRleCIsImZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZCIsInJlc2V0UmVzdGF1cmFudHMiLCJmaWxsUmVzdGF1cmFudHNIVE1MIiwicmVtb3ZlIiwidWwiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJhbHRfdGV4dCIsImNhcmQiLCJocmVmIiwiYWRkcmVzcyIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJvbiIsIndpbmRvdyIsImxvY2F0aW9uIiwib3B0aW9ucyIsInB1c2giLCJsZWFmIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsImZpbGxCcmVhZGNydW1iIiwiZ2V0UGFyYW1ldGVyQnlOYW1lIiwiZmV0Y2hSZXN0YXVyYW50QnlJZCIsImZpbGxSZXN0YXVyYW50SFRNTCIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmlsbFJldmlld3NIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImRheSIsImFwcGVuZENoaWxkIiwidGltZSIsInJldmlld3MiLCJjb250YWluZXIiLCJub1Jldmlld3MiLCJyZXZpZXciLCJjcmVhdGVSZXZpZXdIVE1MIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsInJlcGxhY2UiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsInJlZ2lzdGVyIiwidGhlbiIsInJlZ2lzdHJhdGlv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Q0EsU0FBQUMsR0FFQW5GLFFBQUFpRixJQUFBLDBCQUFBRSIsImZpbGUiOiJhbGwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAqL1xyXG5jbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGFiYXNlIFVSTC5cclxuICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gODAwMCAvLyBDaGFuZ2UgdGhpcyB0byB5b3VyIHNlcnZlciBwb3J0XHJcbiAgICByZXR1cm4gYGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fS9kYXRhL3Jlc3RhdXJhbnRzLmpzb25gO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRzKGNhbGxiYWNrKSB7XHJcbiAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIub3BlbignR0VUJywgREJIZWxwZXIuREFUQUJBU0VfVVJMKTtcclxuICAgIHhoci5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsgLy8gR290IGEgc3VjY2VzcyByZXNwb25zZSBmcm9tIHNlcnZlciFcclxuICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50cyA9IGpzb24ucmVzdGF1cmFudHM7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudHMpO1xyXG4gICAgICB9IGVsc2UgeyAvLyBPb3BzIS4gR290IGFuIGVycm9yIGZyb20gc2VydmVyLlxyXG4gICAgICAgIGNvbnN0IGVycm9yID0gKGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgc3RhdHVzIG9mICR7eGhyLnN0YXR1c31gKTtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB4aHIuc2VuZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudCA9IHJlc3RhdXJhbnRzLmZpbmQociA9PiByLmlkID09IGlkKTtcclxuICAgICAgICBpZiAocmVzdGF1cmFudCkgeyAvLyBHb3QgdGhlIHJlc3RhdXJhbnRcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICBjYWxsYmFjaygnUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCcsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCByZXN1bHRzID0gcmVzdGF1cmFudHNcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoTmVpZ2hib3Job29kcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKVxyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYC4vcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgcmV0dXJuIChgL2ltZy8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaH1gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1hcCBtYXJrZXIgZm9yIGEgcmVzdGF1cmFudC5cclxuICAgKi9cclxuICAgc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICAvLyBodHRwczovL2xlYWZsZXRqcy5jb20vcmVmZXJlbmNlLTEuMy4wLmh0bWwjbWFya2VyICBcclxuICAgIGNvbnN0IG1hcmtlciA9IG5ldyBMLm1hcmtlcihbcmVzdGF1cmFudC5sYXRsbmcubGF0LCByZXN0YXVyYW50LmxhdGxuZy5sbmddLFxyXG4gICAgICB7dGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgYWx0OiByZXN0YXVyYW50Lm5hbWUsXHJcbiAgICAgIGtleWJvYXJkOiBmYWxzZSwgLy8gcmVtb3ZlcyB0YWJiaW5nIFxyXG4gICAgICB1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudClcclxuICAgICAgfSlcclxuICAgICAgbWFya2VyLmFkZFRvKG5ld01hcCk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH0gXHJcbiAgLyogc3RhdGljIG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XHJcbiAgICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuICAgICAgcG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxyXG4gICAgICB0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxyXG4gICAgICB1cmw6IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXHJcbiAgICAgIG1hcDogbWFwLFxyXG4gICAgICBhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QfVxyXG4gICAgKTtcclxuICAgIHJldHVybiBtYXJrZXI7XHJcbiAgfSAqL1xyXG5cclxufVxyXG5cclxuIiwibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXNcclxudmFyIG5ld01hcFxyXG52YXIgbWFya2VycyA9IFtdXHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgaW5pdE1hcCgpOyAvLyBhZGRlZCBcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbiAgdGFiT3JkZXIoKTtcclxufSk7XHJcblxyXG50YWJPcmRlciA9ICgpID0+IHtcclxuICB2YXIgem9vbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xlYWZsZXQtY29udHJvbC16b29tLWluJyk7XHJcbiAgdmFyIG91dCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xlYWZsZXQtY29udHJvbC16b29tLW91dCcpO1xyXG4gIHZhciBsZWFmID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbGVhZmxldC1jb250cm9sLWF0dHJpYnV0aW9uJyk7XHJcblxyXG4gIGxlYWZbMF0uZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgem9vbVswXS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgb3V0WzBdLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxufVxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIHNlbGVjdC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbWVudScpO1xyXG4gIHNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnTmVpZ2hib3Job29kIEZpbHRlciBNZW51Jyk7XHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udGFiSW5kZXggPSBcIjBcIjtcclxuICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLmN1aXNpbmVzID0gY3Vpc2luZXM7XHJcbiAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgc2VsZWN0LnNldEF0dHJpYnV0ZSgncm9sZScsICdtZW51Jyk7XHJcbiAgc2VsZWN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDdWlzaW5lIEZpbHRlciBNZW51Jyk7XHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgb3B0aW9uLnRhYkluZGV4ID0gXCIwXCI7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxuaW5pdE1hcCA9ICgpID0+IHtcclxuICBzZWxmLm5ld01hcCA9IEwubWFwKCdtYXAnLCB7XHJcbiAgICAgICAgY2VudGVyOiBbNDAuNzIyMjE2LCAtNzMuOTg3NTAxXSxcclxuICAgICAgICB6b29tOiAxMixcclxuICAgICAgICBrZXlib2FyZDogZmFsc2UsXHJcbiAgICAgICAgc2Nyb2xsV2hlZWxab29tOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LmpwZzcwP2FjY2Vzc190b2tlbj17bWFwYm94VG9rZW59Jywge1xyXG4gICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaVlXRnpZV3hoZW1GeU1qTWlMQ0poSWpvaVkycHJkM1F5TXpFd01ERmxZVE4yY0RSd2RHeHpjMnh4TlNKOS42VFdkMGs2bzYwSVBLclVCa0t4Ynd3JyxcclxuICAgIG1heFpvb206IDE4LFxyXG4gICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiIHRhYmluZGV4PVwiLTFcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsICcgK1xyXG4gICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCIgdGFiaW5kZXg9XCItMVwiPkNDLUJZLVNBPC9hPiwgJyArXHJcbiAgICAgICdJbWFnZXJ5IMKpIDxhIGhyZWY9XCJodHRwczovL3d3dy5tYXBib3guY29tL1wiIHRhYmluZGV4PVwiLTFcIj5NYXBib3g8L2E+JyxcclxuICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXHJcbiAgfSkuYWRkVG8obmV3TWFwKTtcclxuXHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxuXHJcbn1cclxuXHJcblxyXG4vKipcclxuICogVXBkYXRlIHBhZ2UgYW5kIG1hcCBmb3IgY3VycmVudCByZXN0YXVyYW50cy5cclxuICovXHJcbnVwZGF0ZVJlc3RhdXJhbnRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IGNTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XHJcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG5cclxuICBjb25zdCBjSW5kZXggPSBjU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG5cclxuICBjb25zdCBjdWlzaW5lID0gY1NlbGVjdFtjSW5kZXhdLnZhbHVlO1xyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcclxuXHJcbiAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgICAgZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgLy8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSBbXTtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XHJcbiAgdWwuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcclxuICBpZiAoc2VsZi5tYXJrZXJzKSB7XHJcbiAgICBzZWxmLm1hcmtlcnMuZm9yRWFjaChtYXJrZXIgPT4gbWFya2VyLnJlbW92ZSgpKTtcclxuICB9XHJcbiAgc2VsZi5tYXJrZXJzID0gW107XHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xyXG4gIH0pO1xyXG4gIGFkZE1hcmtlcnNUb01hcCgpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2UuYWx0ID0gcmVzdGF1cmFudC5hbHRfdGV4dDtcclxuICBpbWFnZS50YWJJbmRleCA9IFwiMFwiO1xyXG4gIGxpLmFwcGVuZChpbWFnZSk7XHJcblxyXG4gIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBjYXJkLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWNhcmQnO1xyXG4gIGxpLmFwcGVuZChjYXJkKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBuYW1lLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LW5hbWUnO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIG5hbWUudGFiSW5kZXggPSBcIjBcIjtcclxuICBuYW1lLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGNhcmQuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LW5laWdoYm9yaG9vZCc7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIG5laWdoYm9yaG9vZC50YWJJbmRleCA9IFwiMFwiO1xyXG4gIGNhcmQuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1hZGRyZXNzJztcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBuZWlnaGJvcmhvb2QudGFiSW5kZXggPSBcIjBcIjtcclxuICBjYXJkLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgcmV0dXJuIGxpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxyXG4gKi9cclxuYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgbWFya2VyLm9uKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgICBmdW5jdGlvbiBvbkNsaWNrKCkge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci5vcHRpb25zLnVybDtcclxuICAgIH1cclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgICBtYXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XHJcbiAgICBtYXAudGFiSW5kZXggPSAtMTtcclxuICB9KTtcclxuXHJcbn0gXHJcblxyXG4iLCJsZXQgcmVzdGF1cmFudDtcclxudmFyIG5ld01hcDtcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIG1hcCBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHsgIFxyXG4gIGluaXRNYXAoKTtcclxufSk7XHJcblxyXG4vKnJlbW92ZXMgbWFwIGFuZCBsaW5rcyBvZiBtYXAgZnJvbSB0YWIgb3JkZXIqL1xyXG50YWJPcmRlciA9ICgpID0+IHtcclxuICB2YXIgem9vbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xlYWZsZXQtY29udHJvbC16b29tLWluJyk7XHJcbiAgdmFyIG91dCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xlYWZsZXQtY29udHJvbC16b29tLW91dCcpO1xyXG4gIHZhciBsZWFmID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbGVhZmxldC1jb250cm9sLWF0dHJpYnV0aW9uJyk7XHJcbiAgdmFyIG1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcclxuXHJcbiAgbGVhZlswXS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxuICB6b29tWzBdLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxuICBvdXRbMF0uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG4gIG1hcC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbn1cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbGVhZmxldCBtYXBcclxuICovXHJcbmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHsgICAgICBcclxuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogW3Jlc3RhdXJhbnQubGF0bG5nLmxhdCwgcmVzdGF1cmFudC5sYXRsbmcubG5nXSxcclxuICAgICAgICB6b29tOiAxNixcclxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LmpwZzcwP2FjY2Vzc190b2tlbj17bWFwYm94VG9rZW59Jywge1xyXG4gICAgICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2lZV0Z6WVd4aGVtRnlNak1pTENKaElqb2lZMnByZDNReU16RXdNREZsWVROMmNEUndkR3h6YzJ4eE5TSjkuNlRXZDBrNm82MElQS3JVQmtLeGJ3dycsXHJcbiAgICAgICAgbWF4Wm9vbTogMTgsXHJcbiAgICAgICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiIHRhYmluZGV4PVwiLTFcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMsICcgK1xyXG4gICAgICAgICAgJzxhIGhyZWY9XCJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wL1wiIHRhYmluZGV4PVwiLTFcIj5DQy1CWS1TQTwvYT4sICcgK1xyXG4gICAgICAgICAgJ0ltYWdlcnkgwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vXCIgdGFiaW5kZXg9XCItMVwiPk1hcGJveDwvYT4nLFxyXG4gICAgICAgIGlkOiAnbWFwYm94LnN0cmVldHMnICAgIFxyXG4gICAgICB9KS5hZGRUbyhuZXdNYXApO1xyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xyXG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5uZXdNYXApO1xyXG4gICAgICB0YWJPcmRlcigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59ICBcclxuIFxyXG4vKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcclxuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICAgICAgem9vbTogMTYsXHJcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XHJcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0gKi9cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcclxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcclxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5jbGFzc05hbWUgPSAnaW5mby1uYW1lJztcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBuYW1lLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcclxuICBcclxuICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xyXG4gIGN1aXNpbmUuY2xhc3NOYW1lID0gJ2luZm8tY3Vpc2luZSc7XHJcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcclxuICBjdWlzaW5lLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcclxuICBcclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xyXG4gIGFkZHJlc3MuY2xhc3NOYW1lID0gJ2luZm8tYWRkcmVzcyc7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgYWRkcmVzcy5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCBcIjBcIik7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHJlc3RhdXJhbnQuYWx0X3RleHQpO1xyXG4gIGltYWdlLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcclxuXHJcblxyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgZmlsbFJldmlld3NIVE1MKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xyXG4gIGhvdXJzLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWhvdXJzJztcclxuICBob3Vycy5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCBcIjBcIik7XHJcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XHJcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xyXG5cclxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xyXG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XHJcblxyXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XHJcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XHJcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSk7XHJcblxyXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmV2aWV3c0hUTUwgPSAocmV2aWV3cyA9IHNlbGYucmVzdGF1cmFudC5yZXZpZXdzKSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xyXG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG5cclxuICBpZiAoIXJldmlld3MpIHtcclxuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcclxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XHJcbiAgfSk7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIFwiMFwiKTtcclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5hbWUuY2xhc3NOYW1lID0gJ3Jldmlldy1uYW1lJztcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xyXG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xyXG5cclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGRhdGUuY2xhc3NOYW1lID0gJ3Jldmlldy1kYXRlJztcclxuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xyXG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgcmF0aW5nLmNsYXNzTmFtZSA9ICdyZXZpZXctcmF0aW5nJztcclxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY29tbWVudHMuY2xhc3NOYW1lID0gJ3Jldmlldy1jb21tZW50cyc7XHJcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xyXG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcclxuICovXHJcbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQ9c2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcclxufVxyXG4vKipcclxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICBpZiAoIXVybClcclxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcclxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcclxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XHJcbiAgaWYgKCFyZXN1bHRzKVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgaWYgKCFyZXN1bHRzWzJdKVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XHJcbn1cclxuIiwiaWYgKCdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3IpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvc3cuanMnKS50aGVuKGZ1bmN0aW9uKHJlZ2lzdHJhdGlvbikge1xyXG4gICAgICAgIC8vIHN1Y2Nlc3NmdWwgcmVnaXN0cmF0aW9uXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NlcnZpY2UgcmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwgd2l0aCBzY29wZTogJywgcmVnaXN0cmF0aW9uLnNjb3BlKTtcclxuICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgLy8gZmFpbGVkIHJlZ2lzdHJhdGlvblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2aWNlIHdvcmtlciBmYWlsZWQ6ICcsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSJdfQ==
